<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>主页</title>
    <link rel="stylesheet" href="../lib/layui/css/layui.css">
    <link rel="stylesheet" href="../css/home.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/add.css">
    <link rel="stylesheet" href="../css/main.css">
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    <div class="header">
        <div class="logo">
            <img src="../images/logo.jpg" alt="">
        </div>
            <div class="banner">
                <img class="logo-icon" src="../images/logo-icon.jpg" alt="">
                <ul class="layui-nav layui-bg-cyan">
                    <li class="layui-nav-item">
                        <a href="javascript:;">供应商管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="home.html">供应商维护</a></dd>
                            <dd><a href="">供应商审核</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">系统设置</a>
                        <dl class="layui-nav-child">
                            <dd><a href="">供应商类别</a></dd>
                            <dd><a href="">发布消息</a></dd>
                            <dd><a href="">发布招商公告</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">个人中心</a>
                        <dl class="layui-nav-child">
                            <dd><a href="">基本信息</a></dd>
                            <dd><a href="">密码修改</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <div>
                <div class="crumb">
                </div>
            </div>
        </div>
        <div class="layui-container mainpage">
            <div class="layui-row">
                <div class="layui-col-xs6">
                    <div class="main_left">
                        <div class="main_left_div">
                            <div class="layui-row">
                                <div class="layui-col-xs3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <span>785</span>
                                          <div>
                                            <img src="../images/31.jpg" alt="">
                                          </div>
                                            <p>供应商数量</p>
                                     </div>
                                </div>
                                <div class="layui-col-xs3">
                                        <div class="grid-demo">
                                            <div class="grid-demo grid-demo-bg1">
                                                <span>56</span>
                                                <div>
                                                    <img src="../images/32.jpg" alt="">
                                                    </div>
                                                    <p>待审核数量</p>
                                                </div>
                                            </div>
                                 </div>
                                        <div class="layui-col-xs3">
                                            <div class="grid-demo grid-demo-bg1">
                                                <div class="grid-demo grid-demo-bg1">
                                                    <span>26</span>
                                                    <div>
                                                        <img src="../images/33.jpg" alt="">
                                </div>
                                                        <p>待评估数量</p>
                                                    </div>
                                                </div>
                                        </div>
                            </div>
                        </div>
                                        <div class="grid-demo zbbox">
                                            <div class="">
                                                <div class="layui-card">
                                                    <div class="layui-card-header"><h3>消息中心<em></em></h3> <a href="" class="more">更多</a></div>
                                                    <div class="layui-card-body zblist">
                                                        <ul>
                                                            <li>
                                                                <a href=""><i class="layui-icon">&#xe68e;</i>北京建筑工程招标消息 （2018-10-23）</a>
                                                            </li>
                                                            <li>
                                                                <a href=""><i class="layui-icon">&#xe68e;</i>北京建筑工程招标消息 （2018-10-23）</a>
                                                            </li>
                                                            <li>
                                                                <a href=""><i class="layui-icon">&#xe68e;</i>北京建筑工程招标消息 （2018-10-23）</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-xs6">
                                    <div class="grid-demo zbbox">
                                        <div class="">
                                            <div class="layui-card">
                                                <div class="layui-card-header"><h3>招标公告<em></em></h3> <a href="" class="more">更多</a></div>
                                                <div class="layui-card-body zblist">
                                                    <ul>
                                                        <li>
                                                            <a href="">北京建筑工程招标公告 （2018-10-23）<i class="layui-icon">&#xe68e;</i></a>
                                                        </li>
                                                        <li>
                                                            <a href="">北京建筑工程招标公告 （2018-10-23）<i class="layui-icon">&#xe68e;</i></a>
                                                        </li>
                                                        <li>
                                                            <a href="">北京建筑工程招标公告 （2018-10-23）<i class="layui-icon">&#xe68e;</i></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <script src="../lib/layui/layui.all.js"></script>
                        <script>
                        var allhtml = $('#tabledata');
                        layui.use('laypage', function() {
                            var laypage = layui.laypage;
                            //执行一个laypage实例
                            laypage.render({
                                limit: 20, // 每页条数
                                elem: 'pages', //注意，这里的 test1 是 ID，不用加 # 号,
                                count: 100 //数据总数，从服务端得到
                            });
                        });
                        // 保存提交添加供应商信息
                        function getmsg(type) {
                            var msg = localStorage.getItem('datalist');
                            var data = {
                                name: $('#name').val(), // 用户名称
                                type: $('#type').val(), // 供方分类
                                diode: $('#diode').val(), //主营资质
                                other: $('#other').val(), // 其他资质
                                brand: $('#brand').val(), // 品牌
                                sales: $('#sales').val(), // 销售类别
                                money: $('#money').val(), // 注册资金
                                legal: $('#legal').val(), // 法人
                                business: $('#business').val(), //主营业务
                                area: $('#area').val(), // 营业区域
                                identify: $('#identify').val(), //纳税人识别号
                                linkman: $('#linkman').val(), // 联系人
                                phone: $('#phone').val(), // 联系电话
                                email: $('#email').val() // 邮箱
                            };
                            for (var i in data) {
                                if (data[i].trim().length == 0) {
                                    layer.msg('请添加完所有的信息');
                                    return
                                }
                            }
                            if (type != undefined) {
                                msg = JSON.parse(msg);
                                msg[type] = data;
                                localStorage.setItem('datalist', JSON.stringify(msg));
                                layer.msg('修改成功');
                                layer.closeAll(); // 关闭layui的弹窗
                            } else {
                                if (msg == null) {
                                    var datalist = [];
                                    datalist.push(data);
                                    localStorage.setItem('datalist', JSON.stringify(datalist));
                                    layer.msg('添加成功');
                                    layer.closeAll(); // 关闭layui的弹窗
                                } else {
                                    msg = JSON.parse(msg);
                                    msg.unshift(data);
                                    localStorage.setItem('datalist', JSON.stringify(msg));
                                    layer.msg('添加成功');
                                    layer.closeAll(); // 关闭layui的弹窗
                                }
                            }
                            getdatas();
                            layer.closeAll(); // 关闭layui的弹窗
                        }
                        getdatas();
                        // 在本地获取所有的商家信息
                        function getdatas() {
                            var data = JSON.parse(localStorage.getItem('datalist'));
                            if (data == null || data.length == 0) {
                                $('#nodata').html('没有数据');
                                data = []
                            }
                            var html = '';
                            data.map(function(item, idx) {
                                html += '<tr>' +
                                    '<td>' + parseInt(idx + 1) + '</td>' +
                                    '<td onclick="chousedata(event,' + idx + ')" style="cursor:pointer;">' + item.name + '</td>' +
                                    '<td>' + item.type + '</td>' +
                                    '<td>' + item.diode + '</td>' +
                                    '<td>' + item.sales + '</td>' +
                                    '<td>' + item.business + '</td>' +
                                    '</tr>'
                            });
                            $('#tabledata').html(html);
                        }
                        //        查询。修改
                        function chousedata(event, idx) {
                            event.stopPropagation(); // 阻止时间冒泡
                            let addhtml = '<div style="padding-top: 20px;"><form class="layui-form"> <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素 -->' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>用户名称</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="name"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>供方分类</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="type"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>主营资质</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="diode"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>其他资质</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="other"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>品牌</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="brand"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>销售类别</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="sales"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>注册资金</p>' +
                                '                <div><input type="number" name="" class="layui-input" id="money"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>法人</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="legal"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div>' +
                                '                <p>主营业务</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="business"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>营业区域</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="area"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>纳税人识别号</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="identify"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix threelist">' +
                                '            <div class="fl">' +
                                '                <p>联系人</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="linkman"></div>' +
                                '            </div>' +
                                '            <div class="fl center">' +
                                '                <p>联系电话</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="phone"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>邮箱</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="email"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>附件清单</p>' +
                                '                <div><button type="button" class="layui-btn" id="upfile1"><i class="layui-icon">&#xe67c;</i>上传文件</button></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>附件清单</p>' +
                                '                <div><button type="button" class="layui-btn" id="upfile2"><i class="layui-icon">&#xe67c;</i>上传文件</button></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="textcenter">' +
                                '            <button class="layui-btn" type="button" onclick="getmsg(' + idx + ')">保存</button>' +
                                '            <button class="layui-btn canclemodel" type="button"  onclick="cancleall()">取消</button>' +
                                '        </div>' +
                                '    </form></div>';
                            $('.canclemodel').click(function() {
                                layer.closeAll()
                            });
                            var datalist = JSON.parse(localStorage.getItem('datalist'));
                            var nowdata = datalist[idx];
                            layer.open({
                                type: 1,
                                title: '查看并修改供应商信息',
                                offset: 't',
                                maxmin: true,
                                //                offset: '100px',
                                area: ['85%', '100%'],
                                content: addhtml // iframe的url
                            });


                            $('#name').val(nowdata.name); // 用户名称
                            $('#type').val(nowdata.type); // 供方分类
                            $('#diode').val(nowdata.diode), //主营资质
                                $('#other').val(nowdata.other), // 其他资质
                                $('#brand').val(nowdata.brand), // 品牌
                                $('#sales').val(nowdata.sales), // 销售类别
                                $('#money').val(nowdata.money), // 注册资金
                                $('#legal').val(nowdata.legal), // 法人
                                $('#business').val(nowdata.business), //主营业务
                                $('#area').val(nowdata.area), // 营业区域
                                $('#identify').val(nowdata.identify), //纳税人识别号
                                $('#linkman').val(nowdata.linkman), // 联系人
                                $('#phone').val(nowdata.phone), // 联系电话
                                $('#email').val(nowdata.email) // 邮箱
                        }
                        // 打开添加供应商信息
                        function openadd() {
                            let addhtml = '<div style="padding-top: 20px;"><form class="layui-form"> <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素 -->' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>用户名称</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="name"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>供方分类</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="type"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>主营资质</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="diode"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>其他资质</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="other"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>品牌</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="brand"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>销售类别</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="sales"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>注册资金</p>' +
                                '                <div><input type="number" name="" class="layui-input" id="money"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>法人</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="legal"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div>' +
                                '                <p>主营业务</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="business"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>营业区域</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="area"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>纳税人识别号</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="identify"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix threelist">' +
                                '            <div class="fl">' +
                                '                <p>联系人</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="linkman"></div>' +
                                '            </div>' +
                                '            <div class="fl center">' +
                                '                <p>联系电话</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="phone"></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>邮箱</p>' +
                                '                <div><input type="text" name="" class="layui-input" id="email"></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="clearfix listitem">' +
                                '            <div class="fl">' +
                                '                <p>附件清单</p>' +
                                '                <div><button type="button" class="layui-btn" id="upfile1"><i class="layui-icon">&#xe67c;</i>上传文件</button></div>' +
                                '            </div>' +
                                '            <div class="fr">' +
                                '                <p>附件清单</p>' +
                                '                <div><button type="button" class="layui-btn" id="upfile2"><i class="layui-icon">&#xe67c;</i>上传文件</button></div>' +
                                '            </div>' +
                                '        </div>' +
                                '        <div class="textcenter">' +
                                '            <button class="layui-btn" type="button" onclick="getmsg()">保存</button>' +
                                '            <button class="layui-btn canclemodel" type="button" onclick="cancleall()">取消</button>' +
                                '        </div>' +
                                '    </form></div>';
                            layer.open({
                                type: 1,
                                title: ['新增供应商信息', 'font-size:16px;'],
                                area: ['80%', '100%'],
                                fixed: false, //不固定
                                offset: 't',
                                maxmin: true,
                                content: addhtml
                            });
                        }

                        function cancleall() {
                            layer.closeAll()
                        }
                        //        查询按钮
                        function searchbox() {
                            let addserarchThml = '<div class="clearfix main">' +
                                '<div class="fl nav">' +
                                '</div>' +
                                '<div class="fr">' +
                                '<div class="top clearfix">' +
                                '<span class="fl title">精品材料设备类 </span><i class="layui-icon-right layui-icon fl"></i>' +
                                '<span class="fl">' +
                                '<input type="text" name="title" id="searchname" placeholder="请输入搜索内容" autocomplete="off" class="layui-input serchipt">' +
                                '</span>' +
                                '<button type="button" class="layui-btn layui-btn" style="height: 30px;line-height:30px;position: relative;top: -1px;" id="closemask">查询</button>' +
                                '</div>' +
                                '<div class="clearfix type2"><span class="fl typespan">分类2:</span>' +
                                '<div class="fl">' +
                                '<select id="firsttype">' +
                                '<option value="前期类">前期类</option>' +
                                '<option value="设计类">设计类</option>' +
                                '<option value="咨询类">咨询类</option>' +
                                '<option value="土建及结构类">土建及结构类</option>' +
                                '<option value="机电安装类">机电安装类</option>' +
                                '<option value="建设材料设备类">建设材料设备类</option>' +
                                '<option value="市政建材类">市政建材类</option>' +
                                '</select>' +
                                '</div>' +
                                '</div>' +
                                '<div class="clearfix type2"><span class="fl typespan">分类1:</span>' +
                                '<div class="fl">' +
                                '<select id="twotype">' +
                                '<option value="百度">百度</option>' +
                                '<option value="天猫">天猫</option>' +
                                '<option value="京东">京东</option>' +
                                '</select>' +
                                '</div>' +
                                '</div>' +
                                '<div class="clearfix " style="padding: 5px 20px;">' +
                                '<span class="fl typespan">名称：</span>' +
                                '<div class="fl"><input type="text" id="nametype"></div>' +
                                '</div>' +
                                '<div class="clearfix" style="padding: 5px 20px;">' +
                                '<span class="fl typespan">品牌：</span>' +
                                '<div class="fl"><input type="text" id="nametype"></div>' +
                                '</div>' +
                                '<div class="clearfix" style="padding: 5px 20px;">' +
                                '<span class="fl typespan">联系人：</span>' +
                                '<div class="fl"><input type="text" id="nametype"></div>' +
                                '</div>' +
                                '<div class="clearfix" style="padding: 5px 20px;">' +
                                '<span class="fl typespan">电话：</span>' +
                                '<div class="fl"><input type="text" id="nametype"></div>' +
                                '</div>' +
                                '</div>' +
                                '</div>'
                            layer.open({
                                type: 1,
                                title: ['查询', 'font-size:16px;'],
                                area: ['80%', '85%'],
                                fixed: false, //不固定
                                maxmin: true,
                                content: addserarchThml
                            });
                            $('#closemask').click(function() {
                                search()
                            });

                            function getVal(controlID, controltype) {
                                var objValue = '';
                                switch (controltype) {
                                    case 'text': //文本输入框
                                        objValue = $.trim($('#' + controlID + '').val()); //取值除去所有的空格
                                        break;
                                    case 'radio': //单选框
                                        objValue = $("input[name='" + controlID + "']:checked").val();
                                        break;
                                    case 'select': //下拉列表
                                        objValue = $("#" + controlID + "").val();
                                        break;
                                    case 'checkbox': //复选框
                                        $("input[name='" + controlID + "']:checked").each(function() {
                                            objValue += $(this).val() + ",";
                                        });
                                        break;
                                    default:
                                        break;
                                }
                                return objValue;
                            }
                            $('#firsttype').change(function() {
                                var world = getVal('firsttype', 'select');
                                $('.top .title').html(world)
                            });
                            $('#twotype').change(function() {
                                var world = getVal('twotype', 'select');
                                $('#searchname').val(world)
                            })
                            // 更多选项展开收齐
                            $('.addmore').click(function() {
                                $('.moredata').slideToggle();
                            });

                            function search() {
                                var name = $('#searchname').val();
                                if (name.trim().length == 0) {
                                    getdata();
                                } else {
                                    var data = JSON.parse(localStorage.getItem('datalist'));
                                    var hasdata = [];
                                    data.map(function(item, idx) {
                                        if (item.name == name) {
                                            hasdata.push(item);
                                        }
                                    });
                                    getdata(hasdata)
                                }
                            };
                            // 在本地获取所有的商家信息
                            function getdata(data) {
                                if (!data) {
                                    data = JSON.parse(localStorage.getItem('datalist'));
                                }
                                if (data == null || data.length == 0) {
                                    $('#nodata').html('没有数据');
                                    data = []
                                }
                                var html = '';
                                data.map(function(item, idx) {
                                    html += '<tr>' +
                                        '<td>' + parseInt(idx + 1) + '</td>' +
                                        '<td onclick="chousedata(event,' + idx + ')" style="cursor:pointer;">' + item.name + '</td>' +
                                        '<td>' + item.type + '</td>' +
                                        '<td>' + item.diode + '</td>' +
                                        '<td>' + item.sales + '</td>' +
                                        '<td>' + item.business + '</td>' +
                                        '</tr>'
                                });
                                allhtml.html(html);
                                layer.closeAll()
                            }

                            // 跳转到表格信息
                            function suppliermsg(obj) {
                                // console.log($(obj).name)
                                parent.$("#nowpage").attr("src", 'pages/supplierinformation.html')
                            }
                            $('.nav li').click(function() {
                                $(this).addClass('active').siblings().removeClass('active');
                                var word = $(this).text();
                                $('.title').html(word)
                            });
                            // 是否有资质
                            $('.zizhi span,.friend span').click(function() {
                                $(this).addClass('hasd').siblings().removeClass('hasd');
                            });
                            // 点击左侧分页
                            $('.page-left').click(function() {
                                var num = parseInt($('.pagenum').html());
                                var numall = parseInt($('.pageAll').html());
                                if (num >= 2) {
                                    num--;
                                }
                                if (num > 1 && num < numall) {
                                    $('.page-left').removeClass('page-end');
                                    $('.page-right').removeClass('page-end')
                                }
                                if (num == 1) {
                                    $('.page-left').addClass('page-end')
                                }
                                $('.pagenum').html(num)
                            });
                            // 点击右侧分页
                            $('.page-right').click(function() {
                                var num = parseInt($('.pagenum').html());
                                var numall = parseInt($('.pageAll').html());
                                if (num <= (numall - 1)) {
                                    num++;
                                }
                                if (num > 1 && num < numall) {
                                    $('.page-left').removeClass('page-end');
                                    $('.page-right').removeClass('page-end')
                                }
                                if (num == numall) {
                                    $('.page-right').addClass('page-end')
                                }
                                $(".pagenum").html(num)
                            });
                            $('.condition span').click(function() {
                                let textval = $(this).text();
                                $('.serchipt').val(textval);
                            });
                        }
                        // 跳转到表格信息
                        function suppliermsg(obj) {
                            // console.log($(obj).name)
                            parent.$("#nowpage").attr("src", 'pages/supplierinformation.html')
                        }
                        </script>
</body>

</html>